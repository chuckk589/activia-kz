(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f687d57"],{9380:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("CExtendedModal",{attrs:{vis:e.modalConfig.show,mData:e.modalConfig.data},on:{"modal-closed":function(t){return e.closeModalHandler()}},scopedSlots:e._u([{key:"content",fn:function(){return[a("CImg",{attrs:{fluidGrow:"",src:e.modalConfig.data.cur.checkPath}})]},proxy:!0}])}),a("CDataTable",{attrs:{items:e.items,fields:e.fields,pagination:"",sorter:"",itemsPerPageSelect:"","column-filter":""},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.item;return[a("td",[a("CButton",{attrs:{shape:"square",size:"sm",color:"primary"},on:{click:function(t){return e.viewCheck(n)}}},[a("CIcon",{attrs:{size:"sm",name:"cilImage"}})],1)],1)]}},{key:"over-table",fn:function(){return[a("CLink",{staticClass:"btn-square btn btn-primary mb-2 btn-sm",attrs:{href:e.getCurrentItems(),download:"table-data.csv",target:"_blank"}},[e._v("Скачать (.csv)")])]},proxy:!0}])})],1)},l=[],o=a("b33f");function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s={name:"Checks",components:{CExtendedModal:o["a"]},data:function(){return{modalConfig:{show:!1,data:{cur:{}}},items:[],fields:[{key:"id",label:"Id"},{key:"fancyId",label:"Id чека"},{key:"credentials",label:"Имя"},{key:"phone",label:"Номер"},{key:"city",label:"Город"},{key:"status",label:"Статус чека"},{key:"createdAt",label:"Дата загрузки"},{key:"action",label:"",filter:!1,sorter:!1}]}},mounted:function(){var e=this;this.$http({method:"GET",url:"/v1/check/"}).then((function(t){e.items=t.data}))},computed:{getRejectReasons:function(){return this.$ctable.check_statuses.map((function(e){return{label:e.comment?e.comment:e.label,value:e.value}}))}},methods:{viewCheck:function(e){var t;this.modalConfig.data={cur:e,fields:[(t={label:"status"},c(t,"label","Статус"),c(t,"key","status"),c(t,"select",this.getRejectReasons),c(t,"value",this.$ctable.check_statuses.find((function(t){return t.label==e.status})).value),t)],footer:"Сохранить",header:"Просмотр чека",type:"viewCheck"},this.modalConfig.show=!0},closeModalHandler:function(){var e=this;if("viewCheck"==this.modalConfig.data.type){var t=this.modalConfig.data.fields[0].value;this.$http({method:"PUT",url:"/v1/check/".concat(this.modalConfig.data.cur.id),data:{status:t}}).then((function(){e.modalConfig.data.cur.status=e.$ctable.check_statuses.find((function(e){return e.value==t})).label}))}},getCurrentItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items,t="Id,Id чека,Имя,Номер,Город,Статус чека,Дата загрузки",a="data:text/csv;charset=utf-8,"+t+"%0A"+encodeURIComponent(e.reduce((function(e,t){return e+="".concat(t.id,",").concat(t.fancyId,",").concat(t.credentials,",").concat(t.phone,",").concat(t.city,",").concat(t.status,",").concat(t.createdAt,"\n"),e}),""));return a}}},r=s,i=a("2877"),u=Object(i["a"])(r,n,l,!1,null,null,null);t["default"]=u.exports},b33f:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("CModal",{attrs:{show:e.vis,title:e.mData.header},on:{"update:show":function(t){e.vis=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("CButton",{attrs:{shape:"square",color:"primary"},on:{click:function(t){return e.closeModal()}}},[e._v(e._s(e.mData.footer))])]},proxy:!0}])},[e._t("content"),e._l(e.mData.fields,(function(t,n){return[e.$scopedSlots[t.label]?[e._t(t.label,null,{item:t})]:t.select?a("CSelect",{key:n,attrs:{label:t.label,value:t.value,options:"bool"==t.select?e.boolSelect:t.select},on:{"update:value":function(a){return e.$set(t,"value",a)}}}):a("CInput",{key:n,attrs:{label:t.label,type:t.type},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}})]}))],2)},l=[],o={name:"ExtendedModal",data:function(){return{boolSelect:[{value:1,label:"Да"},{value:0,label:"Нет"}]}},props:{vis:Boolean,mData:Object},methods:{closeModal:function(){this.vis=!1,this.$emit("modal-closed")}}},c=o,s=a("2877"),r=Object(s["a"])(c,n,l,!1,null,null,null);t["a"]=r.exports}}]);
//# sourceMappingURL=chunk-4f687d57.2943daaa.js.map