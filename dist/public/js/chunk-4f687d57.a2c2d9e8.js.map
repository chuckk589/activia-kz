{"version":3,"sources":["webpack:///./vue/views/Checks.vue?e516","webpack:///vue/views/Checks.vue","webpack:///./vue/views/Checks.vue?1d69","webpack:///./vue/views/Checks.vue","webpack:///./vue/components/table/CExtendedModal.vue?13a1","webpack:///vue/components/table/CExtendedModal.vue","webpack:///./vue/components/table/CExtendedModal.vue?a140","webpack:///./vue/components/table/CExtendedModal.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","modalConfig","show","data","on","$event","closeModalHandler","scopedSlots","_u","key","fn","cur","checkPath","proxy","items","fields","ref","item","viewCheck","staticClass","getCurrentItems","_v","staticRenderFns","name","components","CExtendedModal","label","filter","sorter","mounted","method","url","computed","getRejectReasons","value","methods","footer","header","type","status","then","sum","component","vis","mData","closeModal","_s","_t","_l","field","index","$scopedSlots","select","boolSelect","$set","model","callback","$$v","expression","props"],"mappings":"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","file":"js/chunk-4f687d57.a2c2d9e8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('CExtendedModal',{attrs:{\"vis\":_vm.modalConfig.show,\"mData\":_vm.modalConfig.data},on:{\"modal-closed\":function($event){return _vm.closeModalHandler()}},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [_c('CImg',{attrs:{\"fluidGrow\":\"\",\"src\":_vm.modalConfig.data.cur.checkPath}})]},proxy:true}])}),_c('CDataTable',{attrs:{\"items\":_vm.items,\"fields\":_vm.fields,\"pagination\":\"\",\"sorter\":\"\",\"itemsPerPageSelect\":\"\",\"column-filter\":\"\"},scopedSlots:_vm._u([{key:\"action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_c('CButton',{attrs:{\"size\":\"sm\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.viewCheck(item)}}},[_c('CIcon',{attrs:{\"size\":\"lg\",\"name\":\"cilImage\"}})],1)],1)]}},{key:\"over-table\",fn:function(){return [_c('CLink',{staticClass:\"btn btn-primary mb-2 btn-sm\",attrs:{\"href\":_vm.getCurrentItems(),\"download\":\"table-data.csv\",\"target\":\"_blank\"}},[_vm._v(\"Скачать (.csv)\")])]},proxy:true}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <CExtendedModal @modal-closed=\"closeModalHandler()\" :vis=\"modalConfig.show\" :mData=\"modalConfig.data\">\n      <template #content>\n        <CImg fluidGrow :src=\"modalConfig.data.cur.checkPath\"></CImg>\n      </template>\n    </CExtendedModal>\n    <CDataTable :items=\"items\" :fields=\"fields\" pagination sorter itemsPerPageSelect column-filter>\n      <template #action=\"{ item }\">\n        <td>\n          <CButton @click=\"viewCheck(item)\" size=\"sm\" color=\"primary\">\n            <CIcon size=\"lg\" name=\"cilImage\" />\n          </CButton>\n        </td>\n      </template>\n      <template #over-table>\n        <CLink class=\"btn btn-primary mb-2 btn-sm\" :href=\"getCurrentItems()\" download=\"table-data.csv\" target=\"_blank\">Скачать\n          (.csv)</CLink>\n      </template>\n    </CDataTable>\n  </div>\n\n</template>\n\n\n<script>\nimport CExtendedModal from '../components/table/CExtendedModal.vue'\n\nexport default {\n  name: 'Checks',\n  components: {\n    CExtendedModal\n  },\n  data() {\n    return {\n      modalConfig: {\n        show: false,\n        data: {\n          cur: {}\n        },\n      },\n      items: [],\n      fields: [\n        { key: 'id', label: 'Id' },\n        { key: 'fancyId', label: 'Id чека' },\n        { key: 'credentials', label: 'Имя' },\n        { key: 'phone', label: 'Номер' },\n        { key: 'city', label: 'Город' },\n        { key: 'status', label: 'Статус чека' },\n        { key: 'createdAt', label: 'Дата загрузки' },\n        { key: 'action', label: '', filter: false, sorter: false }\n      ]\n    }\n  },\n  mounted() {\n    this.$http({ method: 'GET', url: `/v1/check/` }).then(e => {\n      this.items = e.data\n    })\n  },\n  computed: {\n    getRejectReasons() {\n      return this.$ctable.check_statuses.map(e=>{\n        return {\n          label: e.comment?e.comment:e.label,\n          value: e.value\n        }\n      })\n    }\n  },\n  methods: {\n    viewCheck(item) {\n      this.modalConfig.data = {\n        cur: item,\n        fields: [\n          { label: 'status', label: 'Статус', key: \"status\", select: this.getRejectReasons, value: this.$ctable.check_statuses.find(c => c.label == item.status).value },\n        ],\n        footer: 'Сохранить',\n        header: 'Просмотр чека',\n        type: 'viewCheck'\n      }\n      this.modalConfig.show = true\n    },\n    closeModalHandler() {\n      if (this.modalConfig.data.type == 'viewCheck') {\n        const status_id = this.modalConfig.data.fields[0].value\n        this.$http({\n          method: 'PUT',\n          url: `/v1/check/${this.modalConfig.data.cur.id}`,\n          data: {\n            status: status_id,\n          }\n        })\n          .then(() => {\n            this.modalConfig.data.cur.status = this.$ctable.check_statuses.find(c => c.value == status_id).label\n          })\n      }\n    },\n    getCurrentItems(items = this.items) {\n      const cols = 'Id,Id чека,Имя,Номер,Город,Статус чека,Дата загрузки'\n      const csvCode = 'data:text/csv;charset=utf-8,' + cols + '%0A' + encodeURIComponent(\n        items.reduce((sum, cur) => {\n          sum += `${cur.id},${cur.fancyId},${cur.credentials},${cur.phone},${cur.city},${cur.status},${cur.createdAt}\\n`\n          return sum\n        }, '')\n      )\n      return csvCode\n    },\n  },\n\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Checks.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Checks.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Checks.vue?vue&type=template&id=5e314900&\"\nimport script from \"./Checks.vue?vue&type=script&lang=js&\"\nexport * from \"./Checks.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CModal',{attrs:{\"show\":_vm.vis,\"title\":_vm.mData.header},on:{\"update:show\":function($event){_vm.vis=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.closeModal()}}},[_vm._v(_vm._s(_vm.mData.footer))])]},proxy:true}])},[_vm._t(\"content\"),_vm._l((_vm.mData.fields),function(field,index){return [(_vm.$scopedSlots[field.label])?[_vm._t(field.label,null,{\"item\":field})]:(field.select)?_c('CSelect',{key:index,attrs:{\"label\":field.label,\"value\":field.value,\"options\":field.select == 'bool' ? _vm.boolSelect : field.select},on:{\"update:value\":function($event){return _vm.$set(field, \"value\", $event)}}}):_c('CInput',{key:index,attrs:{\"label\":field.label,\"type\":field.type},model:{value:(field.value),callback:function ($$v) {_vm.$set(field, \"value\", $$v)},expression:\"field.value\"}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <CModal :show.sync=\"vis\" :title=\"mData.header\">\n    <slot name=\"content\"></slot>\n    <template v-for=\"(field, index) in mData.fields\">\n      <template v-if=\"$scopedSlots[field.label]\">\n        <slot :name=\"field.label\" :item=\"field\" />\n      </template>\n      <CSelect v-else-if=\"field.select\" :label=\"field.label\" :value.sync=\"field.value\"\n        :options=\"field.select == 'bool' ? boolSelect : field.select\" :key=\"index\" />\n      <CInput v-else :label=\"field.label\" v-model=\"field.value\" :key=\"index\" :type=\"field.type\" />\n    </template>\n    <template #footer>\n      <CButton color=\"primary\" @click=\"closeModal()\">{{ mData.footer }}</CButton>\n    </template>\n  </CModal>\n</template>\n\n<script>\nexport default {\n  name: 'ExtendedModal',\n\n  data() {\n    return {\n      boolSelect: [{\n        value: 1,\n        label: \"Да\"\n      },\n      {\n        value: 0,\n        label: \"Нет\"\n      }]\n    }\n  },\n  props: {\n    vis: Boolean,\n    mData: Object\n  },\n  methods: {\n    closeModal() {\n      this.vis = false\n      this.$emit('modal-closed')\n    }\n  },\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CExtendedModal.vue?vue&type=template&id=94345078&\"\nimport script from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}