{"version":3,"sources":["webpack:///./vue/views/Users.vue?f1a3","webpack:///vue/views/Users.vue","webpack:///./vue/views/Users.vue?b0e7","webpack:///./vue/views/Users.vue","webpack:///./vue/components/table/CExtendedModal.vue?9c46","webpack:///vue/components/table/CExtendedModal.vue","webpack:///./vue/components/table/CExtendedModal.vue?a140","webpack:///./vue/components/table/CExtendedModal.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","modalConfig","show","data","on","$event","closeModalHandler","items","fields","scopedSlots","_u","key","fn","ref","item","_v","_s","credentials","promo","registered","locale","role","staticClass","getCurrentItems","proxy","editUser","staticRenderFns","name","components","CExtendedModal","label","filter","sorter","mounted","method","url","computed","join","methods","s","cur","select","value","footer","header","type","component","vis","mData","closeModal","_t","_l","field","index","$scopedSlots","boolSelect","$set","model","callback","$$v","expression","props"],"mappings":"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","file":"js/chunk-4f6560ef.c1bbe507.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('CExtendedModal',{attrs:{\"vis\":_vm.modalConfig.show,\"mData\":_vm.modalConfig.data},on:{\"modal-closed\":function($event){return _vm.closeModalHandler()}}}),_c('CDataTable',{attrs:{\"items\":_vm.items,\"fields\":_vm.fields,\"column-filter\":\"\",\"sorter\":\"\",\"pagination\":\"\",\"itemsPerPageSelect\":\"\"},scopedSlots:_vm._u([{key:\"credentials\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(item.credentials || 'Не указано'))])]}},{key:\"promo\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(item.promo || 'Не указано'))])]}},{key:\"registered\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(item.registered ? 'Да' : 'Нет'))])]}},{key:\"locale\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(_vm.locale(item.locale)))])]}},{key:\"role\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_vm._v(_vm._s(_vm.role(item.role)))])]}},{key:\"over-table\",fn:function(){return [_c('CLink',{staticClass:\"btn btn-primary mb-2 btn-sm\",attrs:{\"href\":_vm.getCurrentItems,\"download\":\"table-data.csv\",\"target\":\"_blank\"}},[_vm._v(\"Скачать (.csv)\")])]},proxy:true},{key:\"action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_c('CDropdown',{staticClass:\"m-2\",attrs:{\"toggler-text\":\"Действия\",\"size\":\"sm\",\"color\":\"primary\"}},[_c('CDropdownItem',{on:{\"click\":function($event){return _vm.editUser(item)}}},[_vm._v(\"Изменить\")])],1)],1)]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <CExtendedModal @modal-closed=\"closeModalHandler()\" :vis=\"modalConfig.show\" :mData=\"modalConfig.data\" />\n    <CDataTable :items=\"items\" :fields=\"fields\" column-filter sorter pagination itemsPerPageSelect>\n      <template #credentials=\"{ item }\">\n        <td>{{ item.credentials || 'Не указано' }}</td>\n      </template>\n      <template #promo=\"{ item }\">\n        <td>{{ item.promo || 'Не указано' }}</td>\n      </template>\n      <template #registered=\"{ item }\">\n        <td>{{ item.registered ? 'Да' : 'Нет' }}</td>\n      </template>\n\n      <template #locale=\"{ item }\">\n        <td>{{ locale(item.locale) }}</td>\n      </template>\n      <template #role=\"{ item }\">\n        <td>{{ role(item.role) }}</td>\n      </template>\n\n      <template #over-table>\n        <CLink  class=\"btn btn-primary mb-2 btn-sm\" :href=\"getCurrentItems\" download=\"table-data.csv\" target=\"_blank\">Скачать\n          (.csv)</CLink>\n      </template>\n      <template #action=\"{ item }\">\n        <td>\n          <CDropdown toggler-text=\"Действия\" class=\"m-2\" size=\"sm\" color=\"primary\">\n            <CDropdownItem @click=\"editUser(item)\">Изменить</CDropdownItem>\n          </CDropdown>\n        </td>\n      </template>\n    </CDataTable>\n    \n  </div>\n\n</template>\n\n\n<script>\nimport CExtendedModal from '../components/table/CExtendedModal.vue'\n//@filtered-items-change=\"getCurrentItems\"\nexport default {\n  name: 'Users',\n  components: {\n    CExtendedModal\n  },\n  data() {\n    return {\n      modalConfig: {\n        show: false,\n        data: {},\n      },\n      items: [],\n      fields: [\n        { key: 'id', label: 'Id' },\n        { key: 'chatId', label: 'Telegram Id' },\n        { key: 'city', label: 'Город' },\n        { key: 'credentials', label: 'Имя' },\n        { key: 'locale', label: 'Язык' },\n        { key: 'phone', label: 'Номер' },\n        { key: 'promo', label: 'Промо' },\n        { key: 'role', label: 'Роль' },\n        { key: 'registered', label: 'Регистрация пройдена' },\n        { key: 'createdAt', label: 'Дата регистрации' },\n        { key: 'action', label: '', filter: false, sorter: false }\n      ]\n    }\n  },\n  mounted() {\n    this.$http({ method: 'GET', url: `/v1/user/` }).then(e => {\n      this.items = e.data\n    })\n  },\n  computed: {\n    getCurrentItems() {\n      const cols = this.fields.filter(f => f.label).map(f => f.label).join(',')\n      const csvCode = 'data:text/csv;charset=utf-8,' + cols + '%0A' + encodeURIComponent(\n        this.items.map((item) => `${item.id},${item.chatId},${item.city},${item.credentials},${item.locale},${item.phone},${item.promo},${item.role},${item.registered ? 'Да' : 'Нет'},${item.createdAt}`)\n          .join('\\n')\n      )\n      return csvCode\n    },\n  },\n  methods: {\n    locale(locale) {\n      return locale == 'ru' ? 'Русский' : 'Узбекский'\n    },\n    role(role) {\n      return role == 'user' ? 'Пользователь' : 'Администратор'\n    },\n    closeModalHandler() {\n      if (this.modalConfig.data.type == 'edit') {\n        const data = this.modalConfig.data.fields.reduce((s, c) => {\n          s[c.key] = c.value\n          this.modalConfig.data.cur[c.key] = c.value\n          return s\n        }, {})\n        this.$http({ method: 'PUT', url: `/v1/user/${this.modalConfig.data.cur.id}`, data: data })\n      }\n    },\n    editUser(item) {\n      this.modalConfig.data = {\n        cur: item,\n        fields: [\n          { key: 'city', label: 'Город', select: this.$ctable.cities, value: this.$ctable.cities.find(c => c.label == item.city)?.value },\n          { key: 'credentials', label: 'Имя', value: item.credentials },\n          { key: 'locale', label: 'Язык', select: this.$ctable.locales, value: item.locale },\n          { key: 'phone', label: 'Номер', value: item.phone },\n          { key: 'role', label: 'Роль', select: this.$ctable.roles, value: item.role },\n          { key: 'registered', label: 'Регистрация пройдена', select: \"bool\", value: item.registered },\n          { key: 'promo', label: 'Промо', select: this.$ctable.promotions, value: this.$ctable.promotions.find(c => c.label == item.promo)?.value },\n        ],\n        footer: 'Сохранить',\n        header: 'Редактировать',\n        type: 'edit'\n      }\n      this.modalConfig.show = true\n    }\n  },\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Users.vue?vue&type=template&id=5a903600&\"\nimport script from \"./Users.vue?vue&type=script&lang=js&\"\nexport * from \"./Users.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CModal',{attrs:{\"show\":_vm.vis,\"title\":_vm.mData.header},on:{\"update:show\":function($event){_vm.vis=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.closeModal()}}},[_vm._v(_vm._s(_vm.mData.footer))])]},proxy:true}])},[_vm._t(\"content\"),_vm._l((_vm.mData.fields),function(field,index){return [(_vm.$scopedSlots[field.label])?[_vm._t(field.label,null,{\"item\":field})]:(field.select)?_c('CSelect',{key:index,attrs:{\"label\":field.label,\"value\":field.value,\"options\":field.select == 'bool' ? _vm.boolSelect : field.select},on:{\"update:value\":function($event){return _vm.$set(field, \"value\", $event)}}}):_c('CInput',{key:index,attrs:{\"label\":field.label,\"type\":field.type},model:{value:(field.value),callback:function ($$v) {_vm.$set(field, \"value\", $$v)},expression:\"field.value\"}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <CModal :show.sync=\"vis\" :title=\"mData.header\">\n    <slot name=\"content\"></slot>\n    <template v-for=\"(field, index) in mData.fields\">\n      <template v-if=\"$scopedSlots[field.label]\">\n        <slot :name=\"field.label\" :item=\"field\" />\n      </template>\n      <CSelect v-else-if=\"field.select\" :label=\"field.label\" :value.sync=\"field.value\"\n        :options=\"field.select == 'bool' ? boolSelect : field.select\" :key=\"index\" />\n      <CInput v-else :label=\"field.label\" v-model=\"field.value\" :key=\"index\" :type=\"field.type\" />\n    </template>\n    <template #footer>\n      <CButton color=\"primary\" @click=\"closeModal()\">{{ mData.footer }}</CButton>\n    </template>\n  </CModal>\n</template>\n\n<script>\nexport default {\n  name: 'ExtendedModal',\n\n  data() {\n    return {\n      boolSelect: [{\n        value: 1,\n        label: \"Да\"\n      },\n      {\n        value: 0,\n        label: \"Нет\"\n      }]\n    }\n  },\n  props: {\n    vis: Boolean,\n    mData: Object\n  },\n  methods: {\n    closeModal() {\n      this.vis = false\n      this.$emit('modal-closed')\n    }\n  },\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CExtendedModal.vue?vue&type=template&id=94345078&\"\nimport script from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}