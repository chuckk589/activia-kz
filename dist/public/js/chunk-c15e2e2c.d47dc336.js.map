{"version":3,"sources":["webpack:///./vue/views/Lottery.vue?30dc","webpack:///./vue/views/Lottery.vue?423f","webpack:///vue/views/Lottery.vue","webpack:///./vue/views/Lottery.vue?28b8","webpack:///./vue/views/Lottery.vue","webpack:///./vue/components/table/CExtendedModal.vue?13a1","webpack:///vue/components/table/CExtendedModal.vue","webpack:///./vue/components/table/CExtendedModal.vue?a140","webpack:///./vue/components/table/CExtendedModal.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","modalConfig","show","data","on","$event","closeModalHandler","scopedSlots","_u","key","fn","path","_e","proxy","items","fields","rowClick","staticClass","getCurrentItems","_v","staticStyle","newLotteryInit","ref","item","changeLotteryStatus","deleteLottery","Boolean","_toggled","collapseDuration","_l","winner","index","_s","primary","confirmed","notified","fancyId","credentials","phone","city","viewCheck","checkPath","sendNotify","approveWinner","staticRenderFns","name","components","CExtendedModal","label","filter","sorter","mounted","method","url","methods","footer","header","type","a","rowName","then","select","value","s","status","cur","sum","computed","component","vis","mData","closeModal","_t","field","$scopedSlots","boolSelect","$set","model","callback","$$v","expression","props"],"mappings":"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","file":"js/chunk-c15e2e2c.d47dc336.js","sourcesContent":["export * from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lottery.vue?vue&type=style&index=0&id=376dccf4&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('CExtendedModal',{attrs:{\"vis\":_vm.modalConfig.show,\"mData\":_vm.modalConfig.data},on:{\"modal-closed\":function($event){return _vm.closeModalHandler()}},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [(_vm.modalConfig.data.path)?_c('CImg',{attrs:{\"fluidGrow\":\"\",\"src\":_vm.modalConfig.data.path}}):_vm._e()]},proxy:true}])}),_c('CDataTable',{attrs:{\"sorter\":\"\",\"hover\":\"\",\"items\":_vm.items,\"fields\":_vm.fields,\"column-filter\":\"\"},on:{\"row-clicked\":_vm.rowClick},scopedSlots:_vm._u([{key:\"over-table\",fn:function(){return [_c('CLink',{staticClass:\"btn btn-primary mb-2 btn-sm\",attrs:{\"href\":_vm.getCurrentItems(),\"download\":\"table-data.csv\",\"target\":\"_blank\"}},[_vm._v(\"Скачать (.csv)\")]),_c('CButton',{staticClass:\"btn btn-primary mb-2\",staticStyle:{\"margin-left\":\"3px\"},attrs:{\"size\":\"sm\"},on:{\"click\":_vm.newLotteryInit}},[_vm._v(\"Новый розыгрыш\")])]},proxy:true},{key:\"action\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('td',[_c('CDropdown',{staticClass:\"m-2\",attrs:{\"size\":\"sm\",\"toggler-text\":\"Действия\",\"color\":\"primary\"}},[_c('CDropdownItem',{on:{\"click\":function($event){return _vm.changeLotteryStatus(item)}}},[_vm._v(\"Изменить\")]),_c('CDropdownItem',{on:{\"click\":function($event){return _vm.deleteLottery(item)}}},[_vm._v(\"Удалить\")])],1)],1)]}},{key:\"details\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('CCollapse',{staticClass:\"subtable\",attrs:{\"show\":Boolean(item._toggled),\"duration\":_vm.collapseDuration}},[_c('CRow',[_c('CCol',[_vm._v(\"Основной\")]),_c('CCol',[_vm._v(\"Подтвержден\")]),_c('CCol',[_vm._v(\"Уведомлен\")]),_c('CCol',[_vm._v(\"Id чека\")]),_c('CCol',[_vm._v(\"Имя\")]),_c('CCol',[_vm._v(\"Номер\")]),_c('CCol',[_vm._v(\"Город\")]),_c('CCol',[_vm._v(\"Чек\")]),_c('CCol')],1),_vm._l((item.winners),function(winner,index){return _c('CRow',{key:index},[_c('CCol',[_vm._v(_vm._s(winner.primary ? \"Да\" : \"Нет\"))]),_c('CCol',[_vm._v(_vm._s(winner.confirmed ? \"Да\" : \"Нет\"))]),_c('CCol',[_vm._v(_vm._s(winner.notified ? \"Да\" : \"Нет\"))]),_c('CCol',[_vm._v(_vm._s(winner.fancyId))]),_c('CCol',[_vm._v(_vm._s(winner.credentials))]),_c('CCol',[_vm._v(_vm._s(winner.phone))]),_c('CCol',[_vm._v(_vm._s(winner.city))]),_c('CCol',[_c('CButton',{attrs:{\"size\":\"sm\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.viewCheck(winner.checkPath)}}},[_c('CIcon',{attrs:{\"size\":\"lg\",\"name\":\"cilImage\"}})],1)],1),_c('CCol',[_c('CDropdown',{staticClass:\"m-2\",attrs:{\"toggler-text\":\"Действия\",\"size\":\"sm\",\"color\":\"primary\"}},[_c('CDropdownItem',{on:{\"click\":function($event){return _vm.sendNotify(winner)}}},[_vm._v(\"Уведомить о выигрыше\")]),_c('CDropdownItem',{on:{\"click\":function($event){return _vm.approveWinner(winner)}}},[_vm._v(\"Подтвердить\")])],1)],1)],1)})],2)]}}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <CExtendedModal @modal-closed=\"closeModalHandler()\" :vis=\"modalConfig.show\" :mData=\"modalConfig.data\">\n      <template #content>\n        <CImg v-if=\"modalConfig.data.path\" fluidGrow :src=\"modalConfig.data.path\"></CImg>\n      </template>\n    </CExtendedModal>\n    <CDataTable sorter hover :items=\"items\" :fields=\"fields\" column-filter @row-clicked=\"rowClick\">\n      <template #over-table>\n        <CLink class=\"btn btn-primary mb-2 btn-sm\" :href=\"getCurrentItems()\" download=\"table-data.csv\" target=\"_blank\">Скачать\n          (.csv)</CLink>\n        <CButton size=\"sm\" style=\"margin-left:3px;\" class=\"btn btn-primary mb-2\" @click=\"newLotteryInit\">Новый розыгрыш</CButton>\n      </template>\n      <template #action=\"{ item }\">\n        <td>\n          <CDropdown size=\"sm\" toggler-text=\"Действия\" class=\"m-2\" color=\"primary\">\n            <CDropdownItem @click=\"changeLotteryStatus(item)\">Изменить</CDropdownItem>\n            <CDropdownItem @click=\"deleteLottery(item)\">Удалить</CDropdownItem>\n          </CDropdown>\n        </td>\n      </template>\n      <template #details=\"{ item }\">\n        <CCollapse class=\"subtable\" :show=\"Boolean(item._toggled)\" :duration=\"collapseDuration\">\n          <CRow>\n            <CCol>Основной</CCol>\n            <CCol>Подтвержден</CCol>\n            <CCol>Уведомлен</CCol>\n            <CCol>Id чека</CCol>\n            <CCol>Имя</CCol>\n            <CCol>Номер</CCol>\n            <CCol>Город</CCol>\n            <CCol>Чек</CCol>\n            <CCol></CCol>\n          </CRow>\n          <CRow v-for=\"(winner, index) in item.winners\" :key=\"index\">\n            <CCol>{{ winner.primary ? \"Да\" : \"Нет\" }}</CCol>\n            <CCol>{{ winner.confirmed ? \"Да\" : \"Нет\" }}</CCol>\n            <CCol>{{ winner.notified ? \"Да\" : \"Нет\" }}</CCol>\n            <CCol>{{ winner.fancyId }}</CCol>\n            <CCol>{{ winner.credentials }}</CCol>\n            <CCol>{{ winner.phone }}</CCol>\n            <CCol>{{ winner.city }}</CCol>\n            <CCol>\n              <CButton size=\"sm\" @click=\"viewCheck(winner.checkPath)\" color=\"primary\">\n                <CIcon size=\"lg\" name=\"cilImage\" />\n              </CButton>\n            </CCol>\n            <CCol>\n              <CDropdown toggler-text=\"Действия\" class=\"m-2\" size=\"sm\" color=\"primary\">\n                <CDropdownItem @click=\"sendNotify(winner)\">Уведомить о выигрыше</CDropdownItem>\n                <CDropdownItem @click=\"approveWinner(winner)\">Подтвердить</CDropdownItem>\n              </CDropdown>\n            </CCol>\n          </CRow>\n        </CCollapse>\n      </template>\n    </CDataTable>\n  </div>\n\n</template>\n\n\n<script>\nimport CExtendedModal from '../components/table/CExtendedModal.vue'\n\nexport default {\n  name: 'Lottery',\n  components: {\n    CExtendedModal\n  },\n  data() {\n    return {\n      collapseDuration: 0,\n      modalConfig: {\n        show: false,\n        data: {},\n      },\n      items: [],\n      fields: [\n        { key: 'id', label: 'Id Розыгрыша' },\n        { key: 'start', label: 'Начало' },\n        { key: 'end', label: 'Конец' },\n        { key: 'status', label: 'Статус' },\n        { key: 'prize', label: 'Приз' },\n        { key: 'primaryWinners', label: 'Основные победители' },\n        { key: 'reserveWinners', label: 'Резервные победители' },\n        { key: 'createdAt', label: 'Дата создания' },\n        { key: 'action', label: '', filter: false, sorter: false }\n      ]\n    }\n  },\n  mounted() {\n    this.$http({ method: 'GET', url: `/v1/lottery/` }).then(e => {\n      this.items = e.data\n    })\n  },\n  methods: {\n    viewCheck(path) {\n      this.modalConfig.data = {\n        path: path,\n        footer: 'Ок',\n        header: 'Просмотр чека',\n        type: 'viewCheck'\n      }\n      this.modalConfig.show = true\n    },\n    rowClick(item, a, rowName) {\n      if (rowName !== 'details' && rowName !== 'action') {\n        item._toggled = !item._toggled\n        this.collapseDuration = 300\n        this.$nextTick(() => { this.collapseDuration = 0 })\n      }\n    },\n    sendNotify(item) {\n      this.$http({ method: 'POST', url: `/v1/winner/${item.id}/notification` }).then(e => {\n        item.notified = true\n      })\n    },\n    approveWinner(item) {\n      this.$http({\n        method: 'PUT', url: `/v1/winner/${item.id}`, data: {\n          confirmed: \"1\"\n        }\n      }).then(e => {\n        item.confirmed = true\n      })\n    },\n    newLotteryInit() {\n      this.modalConfig.data = {\n        fields: [\n          { label: 'Дата розыгрыша', key: \"start\", type: \"date\" },\n          { label: 'Конец', key: 'end', type: \"date\" },\n          { label: 'Что разыгрываем', key: \"prize\", select: this.$ctable.prizes, value: this.$ctable.prizes[0].value },\n          { label: 'Основные победители', key: \"primaryWinners\", type: \"number\" },\n          { label: 'Запасные победители', key: \"reserveWinners\", type: \"number\" }\n        ],\n        footer: 'Создать',\n        header: 'Новый розыгрыш',\n        type: 'newLottery'\n      }\n      this.modalConfig.show = true\n    },\n    closeModalHandler() {\n      if (this.modalConfig.data.type == 'newLottery') {\n        const data = this.modalConfig.data.fields.reduce((s, c) => {\n          s[c.key] = c.value\n          return s\n        }, {})\n        this.$http({ method: 'POST', url: `/v1/lottery/`, data: data })\n          .then((r) => {\n            this.modalConfig.show = false\n            this.items.push(r.data)\n          })\n      } else if (this.modalConfig.data.type == 'editLottery') {\n        const status_id = this.modalConfig.data.fields[0].value\n        this.$http({ method: 'PUT', url: `/v1/lottery/${this.modalConfig.data.cur.id}`, data: { status: status_id } })\n          .then(() => {\n            this.modalConfig.data.cur.status = this.$ctable.lottery_statuses.find(c => c.value == status_id).label\n          })\n      } else if (this.modalConfig.data.type == 'deleteLottery') {\n        this.$http({\n          method: 'DELETE',\n          url: `/v1/lottery/${this.modalConfig.data.cur.id}`,\n        })\n          .then(() => {\n            const idx = this.items.findIndex(i => i.id == this.modalConfig.data.cur.id)\n            this.items.splice(idx, 1)\n            this.modalConfig.show = false\n          })\n      }\n    },\n    changeLotteryStatus(item) {\n      this.modalConfig.data = {\n        cur: item,\n        fields: [\n          { key: 'status', label: 'Статус', select: this.$ctable.lottery_statuses, value: this.$ctable.lottery_statuses.find(c => c.label == item.status)?.value },\n        ],\n        footer: 'Сохранить',\n        header: 'Статус розыгрыша',\n        type: 'editLottery'\n      }\n      this.modalConfig.show = true\n    },\n    deleteLottery(item) {\n      this.modalConfig.data = {\n        cur: item,\n        fields: [],\n        footer: 'Подтвердить',\n        header: 'Удалить розыгрыш?',\n        type: 'deleteLottery'\n      }\n      this.modalConfig.show = true\n    },\n    getCurrentItems(items = this.items) {\n      const cols = 'Id Розыгрыша,Дата,Приз,Основной,Подтвержден,Уведомлен,Id чека,Имя,Номер,Город'\n      const csvCode = 'data:text/csv;charset=utf-8,' + cols + '%0A' + encodeURIComponent(\n        items.reduce((sum, cur) => {\n          const header = `${cur.id},${cur.createdAt},${cur.prize},${cur.primary ? 'Да' : 'Нет'},${cur.confirmed ? 'Да' : 'Нет'},${cur.notified ? 'Да' : 'Нет'}`\n          cur.winners.forEach(w => {\n            sum = sum + header + `,${w.fancyId},${w.credentials},${w.phone},${w.city}\\n`\n          })\n          return sum\n        }, '')\n      )\n      return csvCode\n    },\n  },\n  computed: {\n\n  },\n}\n</script>\n<style scoped>\n.subtable {\n  border-top: 2px solid;\n  border-top-color: #d8dbe0;\n}\n\n.subtable .row {\n  margin: 0;\n}\n\n.subtable .row:first-child {\n  margin-bottom: 10px;\n  font-weight: bold;\n}\n\n.subtable .col {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lottery.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Lottery.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Lottery.vue?vue&type=template&id=376dccf4&scoped=true&\"\nimport script from \"./Lottery.vue?vue&type=script&lang=js&\"\nexport * from \"./Lottery.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Lottery.vue?vue&type=style&index=0&id=376dccf4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"376dccf4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CModal',{attrs:{\"show\":_vm.vis,\"title\":_vm.mData.header},on:{\"update:show\":function($event){_vm.vis=$event}},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('CButton',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){return _vm.closeModal()}}},[_vm._v(_vm._s(_vm.mData.footer))])]},proxy:true}])},[_vm._t(\"content\"),_vm._l((_vm.mData.fields),function(field,index){return [(_vm.$scopedSlots[field.label])?[_vm._t(field.label,null,{\"item\":field})]:(field.select)?_c('CSelect',{key:index,attrs:{\"label\":field.label,\"value\":field.value,\"options\":field.select == 'bool' ? _vm.boolSelect : field.select},on:{\"update:value\":function($event){return _vm.$set(field, \"value\", $event)}}}):_c('CInput',{key:index,attrs:{\"label\":field.label,\"type\":field.type},model:{value:(field.value),callback:function ($$v) {_vm.$set(field, \"value\", $$v)},expression:\"field.value\"}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <CModal :show.sync=\"vis\" :title=\"mData.header\">\n    <slot name=\"content\"></slot>\n    <template v-for=\"(field, index) in mData.fields\">\n      <template v-if=\"$scopedSlots[field.label]\">\n        <slot :name=\"field.label\" :item=\"field\" />\n      </template>\n      <CSelect v-else-if=\"field.select\" :label=\"field.label\" :value.sync=\"field.value\"\n        :options=\"field.select == 'bool' ? boolSelect : field.select\" :key=\"index\" />\n      <CInput v-else :label=\"field.label\" v-model=\"field.value\" :key=\"index\" :type=\"field.type\" />\n    </template>\n    <template #footer>\n      <CButton color=\"primary\" @click=\"closeModal()\">{{ mData.footer }}</CButton>\n    </template>\n  </CModal>\n</template>\n\n<script>\nexport default {\n  name: 'ExtendedModal',\n\n  data() {\n    return {\n      boolSelect: [{\n        value: 1,\n        label: \"Да\"\n      },\n      {\n        value: 0,\n        label: \"Нет\"\n      }]\n    }\n  },\n  props: {\n    vis: Boolean,\n    mData: Object\n  },\n  methods: {\n    closeModal() {\n      this.vis = false\n      this.$emit('modal-closed')\n    }\n  },\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CExtendedModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CExtendedModal.vue?vue&type=template&id=94345078&\"\nimport script from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\nexport * from \"./CExtendedModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}